<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  DirectoryIndex index.html
  Options -MultiViews

  # 1. FORCE TRAILING SLASH
  # Redirect /slug to /slug/
  RewriteCond %{REQUEST_URI} !/$
  RewriteRule ^(lavadora|lavadora2|motoserra|motoserra2)$ /$1/ [R=301,L]

  # 2. WHITELIST STATIC ROUTES (Prevent SPA Fallback)
  # If the request matches these folders, STOP rewriting and let Apache serve files.
  # Using REQUEST_URI is often more robust against per-directory context weirdness.
  RewriteCond %{REQUEST_URI} ^/(lavadora|lavadora2|motoserra|motoserra2)(/|$) [NC]
  RewriteRule ^ - [L]

  # 3. WHITELIST ASSETS
  RewriteCond %{REQUEST_URI} ^/assets/ [NC]
  RewriteRule ^ - [L]
  
  RewriteCond %{REQUEST_URI} ^/overrides\.(css|js)$ [NC]
  RewriteRule ^ - [L]

  # 4. SPA FALLBACK
  # If not a file/dir, serve root app.
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule . /index.html [L]
</IfModule>
